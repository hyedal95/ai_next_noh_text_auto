<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì˜†ìë¦¬ë…¸ì‚¬ì› - ì¸ìŠ¤íƒ€ ê¸€ì“°ê¸° ì—ì´ì „íŠ¸</title>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;700&display=swap" rel="stylesheet">
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: 'Noto Sans KR', sans-serif;
            background: #f0f2f5;
            min-height: 100vh;
            color: #1d1d1f;
        }

        /* í—¤ë” ìŠ¤íƒ€ì¼ */
        .header {
            background: white;
            padding: 1.5rem 0;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
            position: sticky;
            top: 0;
            z-index: 100;
        }
        .header-content {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 2rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .logo { font-size: 1.5rem; font-weight: 800; color: #E1306C; }

        /* ë©”ì¸ ë ˆì´ì•„ì›ƒ */
        .container {
            max-width: 1200px;
            margin: 2rem auto;
            padding: 0 2rem;
            display: grid;
            grid-template-columns: 1fr 400px; /* ì…ë ¥ì°½ : ë¯¸ë¦¬ë³´ê¸°ì°½ */
            gap: 40px;
        }

        @media (max-width: 900px) {
            .container { grid-template-columns: 1fr; }
        }

        /* ì¹´ë“œ ê³µí†µ */
        .card {
            background: white;
            border-radius: 16px;
            padding: 2rem;
            box-shadow: 0 4px 12px rgba(0,0,0,0.05);
        }

        /* ì£¼ì œ ë²„íŠ¼ ê·¸ë¦¬ë“œ */
        .theme-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(140px, 1fr));
            gap: 12px;
            margin-bottom: 2rem;
        }
        .theme-btn {
            padding: 1rem;
            border: 2px solid #eee;
            border-radius: 12px;
            background: white;
            cursor: pointer;
            transition: all 0.2s;
            text-align: center;
        }
        .theme-btn:hover { border-color: #E1306C; background: #fff5f8; }
        .theme-btn.active { 
            border-color: #E1306C; 
            background: #E1306C; 
            color: white;
            font-weight: bold;
        }
        .emoji { font-size: 1.5rem; display: block; margin-bottom: 0.5rem; }

        /* ì…ë ¥ í•„ë“œ ë° ë²„íŠ¼ */
        .input-group { margin-bottom: 1.5rem; }
        .input-group input {
            width: 100%; padding: 1rem;
            border: 2px solid #eee; border-radius: 12px;
            font-size: 1rem;
        }
        .btn-generate {
            width: 100%; padding: 1.2rem;
            background: linear-gradient(45deg, #405DE6, #5851DB, #833AB4, #C13584, #E1306C, #FD1D1D);
            color: white; border: none; border-radius: 12px;
            font-size: 1.2rem; font-weight: bold; cursor: pointer;
            transition: transform 0.2s;
        }
        .btn-generate:hover { transform: translateY(-2px); box-shadow: 0 4px 12px rgba(0,0,0,0.2); }
        .btn-generate:disabled { opacity: 0.7; cursor: wait; }

        /* ì¸ìŠ¤íƒ€ê·¸ë¨ ë¯¸ë¦¬ë³´ê¸° (í° ëª©ì—…) */
        .phone-mockup {
            border: 12px solid #1d1d1f;
            border-radius: 40px;
            background: white;
            overflow: hidden;
            position: relative;
            min-height: 700px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.2);
        }
        .notch {
            width: 150px; height: 25px; background: #1d1d1f;
            position: absolute; top: 0; left: 50%; transform: translateX(-50%);
            border-bottom-left-radius: 16px; border-bottom-right-radius: 16px;
            z-index: 10;
        }
        
        /* ì¸ìŠ¤íƒ€ UI */
        .insta-header {
            padding: 40px 16px 10px;
            display: flex; align-items: center; gap: 10px;
            border-bottom: 1px solid #efefef;
        }
        .profile-pic { width: 32px; height: 32px; background: #ddd; border-radius: 50%; }
        .username { font-weight: 600; font-size: 14px; }
        
        .insta-placeholder-img {
            width: 100%; height: 350px;
            background: linear-gradient(120deg, #a1c4fd 0%, #c2e9fb 100%);
            display: flex; justify-content: center; align-items: center;
            color: white; font-size: 1.2rem; font-weight: bold;
            text-align: center; padding: 20px;
        }

        .insta-actions { padding: 10px 16px; font-size: 24px; display: flex; gap: 16px; }
        
        .insta-content { padding: 0 16px 20px; font-size: 14px; line-height: 1.6; }
        .likes { font-weight: 600; margin-bottom: 8px; display: block; }
        .caption-text { white-space: pre-wrap; word-break: break-all; }
        .highlight-hook { font-weight: bold; color: #262626; display: block; margin-bottom: 8px; }
        .hashtags { color: #00376b; margin-top: 10px; display: block; }

        /* ë³µì‚¬ ë²„íŠ¼ */
        .btn-copy {
            margin-top: 1rem;
            width: 100%; padding: 1rem;
            background: #efefef; border: none; border-radius: 8px;
            font-weight: 600; cursor: pointer;
        }
        .btn-copy:hover { background: #e0e0e0; }

        /* ë¡œë”© ì• ë‹ˆë©”ì´ì…˜ */
        .loading-spinner {
            display: inline-block; width: 20px; height: 20px;
            border: 3px solid rgba(255,255,255,0.3);
            border-top-color: white; border-radius: 50%;
            animation: spin 1s linear infinite; margin-right: 8px;
        }
        @keyframes spin { to { transform: rotate(360deg); } }

        /* ë¡œê·¸ì¸ ëª¨ë‹¬ */
        .login-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.5); z-index: 1000;
            display: flex; justify-content: center; align-items: center;
        }
        .login-box {
            background: white; padding: 2rem; border-radius: 16px;
            width: 90%; max-width: 400px;
            text-align: center;
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <script type="text/babel">
        const { useState, useEffect } = React;

        function App() {
            // ë¡œê·¸ì¸ ìƒíƒœ
            const [apiKey, setApiKey] = useState(localStorage.getItem('geminiApiKey') || '');
            const [userName, setUserName] = useState(localStorage.getItem('userName') || '');
            const [isLoggedIn, setIsLoggedIn] = useState(false);

            // ì•± ìƒíƒœ
            const [selectedTheme, setSelectedTheme] = useState('');
            const [customTopic, setCustomTopic] = useState('');
            const [isLoading, setIsLoading] = useState(false);
            
            // ê²°ê³¼ ìƒíƒœ
            const [result, setResult] = useState(null); // { hook, body, hashtags }

            const themes = [
                { id: 'monday', name: 'ì›”ìš”ë³‘ í‡´ì¹˜', emoji: 'ğŸ˜«', prompt: 'ì›”ìš”ì¼ ì•„ì¹¨ ì§ì¥ì¸ì´ ê³µê°í•  ë§Œí•œ í”¼ê³¤í•¨ê³¼ í•´íƒˆì„ ìœ ë¨¸ëŸ¬ìŠ¤í•˜ê²Œ í‘œí˜„' },
                { id: 'meeting', name: 'ë„¤ë²„ì—”ë”© íšŒì˜', emoji: 'ğŸ—£ï¸', prompt: 'ëë‚˜ì§€ ì•ŠëŠ” íšŒì˜ ì‹œê°„, ë©ë•Œë¦¬ëŠ” ì§ì¥ì¸ì˜ ì†ë§ˆìŒ' },
                { id: 'lunch', name: 'ì ì‹¬ ë©”ë‰´', emoji: 'ğŸ±', prompt: 'ì˜¤ëŠ˜ ë­ ë¨¹ì§€ ê³ ë¯¼í•˜ëŠ” ì§ì¥ì¸ì˜ ìµœëŒ€ ë‚œì œì™€ í–‰ë³µí•œ ê³ ë¯¼' },
                { id: 'leaving', name: 'ì¹¼í‡´ ê¸°ì›', emoji: 'ğŸƒ', prompt: 'í‡´ê·¼ 10ë¶„ ì „ì˜ ì´ˆì¡°í•¨ê³¼ ì¹¼í‡´ë¥¼ í–¥í•œ ê°•í•œ ì§‘ë…' },
                { id: 'mistake', name: 'ì‹¤ìˆ˜ ìˆ˜ìŠµ', emoji: 'ğŸ’¦', prompt: 'ì—…ë¬´ ì‹¤ìˆ˜ í›„ ì‹ì€ë•€ ë‚˜ëŠ” ìƒí™©ê³¼ ëŒ€ì²˜í•˜ëŠ”(ì²™í•˜ëŠ”) ëª¨ìŠµ' },
                { id: 'salary', name: 'ì›”ê¸‰ ë¡œê·¸ì¸', emoji: 'ğŸ’¸', prompt: 'ì›”ê¸‰ì´ ìŠ¤ì³ ì§€ë‚˜ê°€ëŠ” í†µì¥ ì”ê³ ì˜ ìŠ¬í””ê³¼ ê¸ˆìœµì¹˜ë£Œ' },
                { id: 'coffee', name: 'ì¹´í˜ì¸ ìˆ˜í˜ˆ', emoji: 'â˜•', prompt: 'ì»¤í”¼ ì—†ì´ëŠ” ì‹œë™ì´ ì•ˆ ê±¸ë¦¬ëŠ” í˜„ëŒ€ ì§ì¥ì¸ì˜ ë¹„ì• ' },
                { id: 'weekend', name: 'ì£¼ë§ ìˆœì‚­', emoji: 'ğŸš€', prompt: 'ëˆˆ ê¹œì§í•  ìƒˆ ì§€ë‚˜ê°„ ì£¼ë§ê³¼ ë‹¤ê°€ì˜¤ëŠ” ì¶œê·¼ì˜ ê³µí¬' }
            ];

            useEffect(() => {
                if (apiKey && userName) setIsLoggedIn(true);
            }, []);

            const handleLogin = () => {
                if (!apiKey.trim() || !userName.trim()) return alert('ì •ë³´ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”!');
                localStorage.setItem('geminiApiKey', apiKey);
                localStorage.setItem('userName', userName);
                setIsLoggedIn(true);
            };

            const handleLogout = () => {
                localStorage.removeItem('geminiApiKey');
                localStorage.removeItem('userName');
                setIsLoggedIn(false);
                setApiKey('');
                setUserName('');
            };

            const generateText = async () => {
                const themeData = themes.find(t => t.id === selectedTheme);
                const topic = customTopic || themeData?.prompt || 'ì§ì¥ì¸ ì¼ìƒ';
                
                setIsLoading(true);
                setResult(null);

                try {
                    // âœ¨âœ¨ í•µì‹¬ ë³€ê²½: Header ë°©ì‹ìœ¼ë¡œ í˜¸ì¶œ âœ¨âœ¨
                    const response = await fetch(
                        `https://generativelanguage.googleapis.com/v1beta/models/gemini-1.5-flash:generateContent`,
                        {
                            method: 'POST',
                            headers: { 
                                'Content-Type': 'application/json',
                                'X-goog-api-key': apiKey  // ë¸”ë¡œê·¸ì—ì„œ ë³¸ ê·¸ ë°©ì‹!
                            },
                            body: JSON.stringify({
                                contents: [{
                                    parts: [{
                                        text: `
ë‹¹ì‹ ì€ ì¸ìŠ¤íƒ€ê·¸ë¨ ê³„ì • 'ì˜†ìë¦¬ë…¸ì‚¬ì›'ì˜ ìš´ì˜ìì…ë‹ˆë‹¤. 
ë‹¤ìŒ ì£¼ì œì— ë§ì¶° íŒ”ë¡œì›Œë“¤ì˜ ë°˜ì‘(ì¢‹ì•„ìš”, ëŒ“ê¸€)ì„ ì´ëŒì–´ë‚¼ ìˆ˜ ìˆëŠ” ë§¤ë ¥ì ì¸ ê²Œì‹œë¬¼ ë‚´ìš©ì„ ì‘ì„±í•´ì£¼ì„¸ìš”.

ì£¼ì œ: ${topic}

ë°˜ë“œì‹œ ë‹¤ìŒ JSON í˜•ì‹ìœ¼ë¡œë§Œ ë‹µë³€í•´ì£¼ì„¸ìš” (ë§ˆí¬ë‹¤ìš´ ì—†ì´ ìˆœìˆ˜ JSONë§Œ):
{
  "hook": "ì²« ì¤„ì— ë“¤ì–´ê°ˆ ì‹œì„ ì„ ë„ëŠ” ê°•ë ¥í•œ í•œ ë¬¸ì¥ (ì´ëª¨ì§€ í¬í•¨)",
  "body": "ë³¸ë¬¸ ë‚´ìš© (ê³µê°, ìœ ë¨¸, ì¤„ë°”ê¿ˆì„ ì ì ˆíˆ ì‚¬ìš©í•˜ì—¬ ê°€ë…ì„± ë†’ê²Œ ì‘ì„±)",
  "hashtags": "ê´€ë ¨ëœ ì¸ê¸° í•´ì‹œíƒœê·¸ 10~15ê°œ (ì˜ˆ: #ì§ì¥ì¸ #ì¹¼í‡´)"
}`
                                    }]
                                }]
                            })
                        }
                    );

                    const data = await response.json();
                    
                    if (data.error) {
                         alert(`API ì˜¤ë¥˜ ë°œìƒ: ${data.error.message}`);
                         console.error(data.error);
                         return;
                    }

                    if (!data.candidates) throw new Error("API í˜¸ì¶œ ì‹¤íŒ¨ (ì‘ë‹µ ì—†ìŒ)");
                    
                    let rawText = data.candidates[0].content.parts[0].text;
                    // ë§ˆí¬ë‹¤ìš´ ì½”ë“œë¸”ëŸ­ ì œê±° (`json ... `)
                    rawText = rawText.replace(/```json/g, '').replace(/```/g, '').trim();
                    
                    const parsedResult = JSON.parse(rawText);
                    setResult(parsedResult);

                } catch (e) {
                    alert(`ì˜¤ë¥˜ ë°œìƒ: ${e.message}`);
                    console.error(e);
                } finally {
                    setIsLoading(false);
                }
            };

            const copyToClipboard = () => {
                if (!result) return;
                const fullText = `${result.hook}\n\n${result.body}\n\n${result.hashtags}`;
                navigator.clipboard.writeText(fullText);
                alert('âœ¨ í…ìŠ¤íŠ¸ê°€ ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤! ì¸ìŠ¤íƒ€ì— ë¶™ì—¬ë„£ìœ¼ì„¸ìš”.');
            };

            if (!isLoggedIn) {
                return (
                    <div className="login-overlay">
                        <div className="login-box">
                            <h2 style={{marginBottom: '1rem'}}>ğŸš€ ì˜†ìë¦¬ë…¸ì‚¬ì› ì‹œì‘í•˜ê¸°</h2>
                            <input className="input-group" style={{width:'100%', marginBottom:'10px'}} 
                                placeholder="ì‚¬ìš©ì ì´ë¦„ (ì˜ˆ: ë…¸ì‚¬ì›)" value={userName} onChange={e => setUserName(e.target.value)} />
                            <input className="input-group" style={{width:'100%', marginBottom:'20px'}} type="password"
                                placeholder="Gemini API Key" value={apiKey} onChange={e => setApiKey(e.target.value)} />
                            <button className="btn-generate" onClick={handleLogin}>ë¡œê·¸ì¸</button>
                            <p style={{fontSize: '0.8rem', color: '#666', marginTop: '1rem'}}>
                                API KeyëŠ” ë¸Œë¼ìš°ì €ì—ë§Œ ì €ì¥ë©ë‹ˆë‹¤.
                            </p>
                        </div>
                    </div>
                );
            }

            return (
                <div>
                    <header className="header">
                        <div className="header-content">
                            <div className="logo">ğŸ“± ì˜†ìë¦¬ë…¸ì‚¬ì› AI</div>
                            <div>
                                <span style={{marginRight:'10px'}}>ğŸ‘¤ {userName}ë‹˜</span>
                                <button onClick={handleLogout} style={{padding:'5px 10px', cursor:'pointer'}}>ë¡œê·¸ì•„ì›ƒ</button>
                            </div>
                        </div>
                    </header>

                    <div className="container">
                        {/* ì™¼ìª½: ì…ë ¥ ì»¨íŠ¸ë¡¤ */}
                        <div className="left-panel">
                            <div className="card">
                                <h3 style={{marginBottom:'1rem'}}>1. ì–´ë–¤ ê¸€ì„ ì“¸ê¹Œìš”?</h3>
                                <div className="theme-grid">
                                    {themes.map(t => (
                                        <div key={t.id} 
                                            className={`theme-btn ${selectedTheme === t.id ? 'active' : ''}`}
                                            onClick={() => { setSelectedTheme(t.id); setCustomTopic(''); }}
                                        >
                                            <span className="emoji">{t.emoji}</span>
                                            {t.name}
                                        </div>
                                    ))}
                                </div>

                                <div className="input-group">
                                    <label style={{display:'block', marginBottom:'8px', fontWeight:'bold'}}>ì§ì ‘ ì…ë ¥í•˜ê³  ì‹¶ë‹¤ë©´?</label>
                                    <input 
                                        type="text" 
                                        placeholder="ì˜ˆ: íšŒì‹ ìë¦¬ í”¼í•˜ëŠ” ê¿€íŒ ì•Œë ¤ì¤˜"
                                        value={customTopic}
                                        onChange={(e) => { setCustomTopic(e.target.value); setSelectedTheme(''); }}
                                    />
                                </div>

                                <button 
                                    className="btn-generate" 
                                    onClick={generateText}
                                    disabled={isLoading || (!selectedTheme && !customTopic)}
                                >
                                    {isLoading ? <><span className="loading-spinner"></span> ê¸€ ì“°ëŠ” ì¤‘...</> : 'âœ¨ AI ê¸€ ìƒì„±í•˜ê¸°'}
                                </button>
                            </div>
                        </div>

                        {/* ì˜¤ë¥¸ìª½: ë¯¸ë¦¬ë³´ê¸° */}
                        <div className="right-panel">
                            <div className="phone-mockup">
                                <div className="notch"></div>
                                <div className="insta-header">
                                    <div className="profile-pic"></div>
                                    <div className="username">ì˜†ìë¦¬ë…¸ì‚¬ì›_official</div>
                                    <div style={{marginLeft:'auto'}}>â€¢â€¢â€¢</div>
                                </div>
                                
                                {/* ì´ë¯¸ì§€ ì˜ì—­ (í”Œë ˆì´ìŠ¤í™€ë”) */}
                                <div className="insta-placeholder-img">
                                    {isLoading ? 'AIê°€ ìƒê°í•˜ëŠ” ì¤‘...ğŸ§ ' : 
                                     result ? 'ğŸ“· ì—¬ê¸°ì— ì–´ìš¸ë¦¬ëŠ”\nì‚¬ì§„ì„ ë„£ì–´ì£¼ì„¸ìš”' : 'ì£¼ì œë¥¼ ì„ íƒí•˜ë©´\nê¸€ì´ ìƒì„±ë©ë‹ˆë‹¤'}
                                </div>

                                <div className="insta-actions">
                                    <span>â¤ï¸</span> <span>ğŸ’¬</span> <span>âœˆï¸</span>
                                    <span style={{marginLeft:'auto'}}>ğŸ”–</span>
                                </div>

                                <div className="insta-content">
                                    <span className="likes">ì¢‹ì•„ìš” 1,284ê°œ</span>
                                    {result ? (
                                        <>
                                            <span className="highlight-hook">{result.hook}</span>
                                            <div className="caption-text">{result.body}</div>
                                            <div className="hashtags">{result.hashtags}</div>
                                        </>
                                    ) : (
                                        <div style={{color:'#999', padding:'20px 0'}}>
                                            ì™¼ìª½ì—ì„œ ì£¼ì œë¥¼ ì„ íƒí•˜ê³ <br/>'ìƒì„±í•˜ê¸°' ë²„íŠ¼ì„ ëˆŒëŸ¬ë³´ì„¸ìš”!
                                        </div>
                                    )}
                                </div>
                            </div>
                            
                            {result && (
                                <button className="btn-copy" onClick={copyToClipboard}>
                                    ğŸ“‹ ì „ì²´ í…ìŠ¤íŠ¸ ë³µì‚¬í•˜ê¸°
                                </button>
                            )}
                        </div>
                    </div>
                </div>
            );
        }

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
